(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{690:function(t,s,e){"use strict";e.r(s);var a=e(5),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("原文出处："),e("a",{attrs:{href:"https://ty-peng.gitee.io/views/note/ops/202004141352-vuepress-last-updated.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ty-peng - VuePress Last Updated 时间有误的解决"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"此文章为转载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#此文章为转载"}},[t._v("#")]),t._v(" "),e("strong",[t._v("此文章为转载")])]),t._v(" "),e("h2",{attrs:{id:"正文"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#正文"}},[t._v("#")]),t._v(" 正文")]),t._v(" "),e("p",[t._v("之前一直以为文章"),e("code",[t._v("Last Updated")]),t._v("的时间每次都是取最新的时间是因为推送Pages分支时强制提交，只有一个最新提交的原因， 所以一直没去管，今天发觉按理编译之前"),e("code",[t._v("Last Updated")]),t._v("时间就已经确定了才对，于是找了下原因。")]),t._v(" "),e("p",[t._v("去VuePress的文档页面看了下，在默认主题的配置里有说明：")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"title"}),e("p",[t._v("VuePress的插件"),e("code",[t._v("last-updated")]),t._v("是基于"),e("code",[t._v("git")]),t._v("的，使用"),e("code",[t._v("git commit")]),t._v("的时间戳作为最后更新时间。")])]),e("p",[t._v("我在本地编译运行了一下，发现"),e("code",[t._v("Last Updated")]),t._v("时间是对的， 但是通过GitHub Actions编译后的时间有误，都只是最新的时间。")]),t._v(" "),e("p",[t._v("检查workflow文件"),e("code",[t._v("main.yml")]),t._v("， 其中和之前本地部署不同的步骤应该只有"),e("code",[t._v("Checkout")]),t._v("那一步，")]),t._v(" "),e("p",[t._v("找到相关文档，查看配置项，其中有一项：")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"title"}),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Number of commits to fetch. 0 indicates all history.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default: 1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fetch-depth")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n")])])]),e("p",[e("code",[t._v("fetch-depth")]),t._v("：要获取的提交数，0表示所有历史记录，默认为1。")])]),e("p",[t._v("这就是问题的根源所在，在GitHub Actions中，按之前的配置，"),e("code",[t._v("fetch-depth")]),t._v("未配置取默认值1， 使用"),e("code",[t._v("Checkout")]),t._v("插件checkout代码只会fetch一个提交， 所以"),e("code",[t._v("Last Updated")]),t._v("插件获取不到其他文章的正确提交时间， 最后编译时都使用了最后一次提交时间作为最后更新时间。")]),t._v(" "),e("p",[t._v("修改如下：")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Checkout 🛎️\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@v2\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persist-credentials")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Number of commits to fetch. 0 indicates all history.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fetch-depth")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),e("p",[t._v("提交推送远程仓库，自动部署，"),e("code",[t._v("Last Updated")]),t._v("时间恢复正常。")])])}),[],!1,null,null,null);s.default=n.exports}}]);